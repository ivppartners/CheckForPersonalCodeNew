function onMessageSendHandler(e){Office.context.mailbox.item.body.getAsync("text",{asyncContext:e},getBodyCallback)}function getBodyCallback(e){const n=e.asyncContext;let t="";if(e.status===Office.AsyncResultStatus.Failed||void 0===e.value){const e="Failed to get body text";return console.error(e),void n.completed({allowEvent:!1,errorMessage:e})}t=e.value,containsLithuanianPersonalCode(t)?n.completed({allowEvent:!1,errorMessage:"Panašu, kad į laiško tekstą įtraukėte asmens kodą.",errorMessageMarkdown:"Panašu, kad į laiško tekstą įtraukėte asmens kodą.",sendModeOverride:Office.MailboxEnums.SendModeOverride.PromptUser}):n.completed({allowEvent:!0})}function containsLithuanianPersonalCode(e){if(!e||"string"!=typeof e)return!1;const n=e.match(/\b\d{11}\b/g);if(!n)return!1;for(const e of n)if(isValidLithuanianPersonalCode(e))return!0;return!1}function isValidLithuanianPersonalCode(e){if(11!==e.length)return!1;const n=parseInt(e[0],10);if(n<1||n>6)return!1;const t=[1,2,3,4,5,6,7,8,9,1],a=[3,4,5,6,7,8,9,1,2,3],o=e.split("").map(Number),s=o[10],r=o.slice(0,10).reduce(((e,n,a)=>e+n*t[a]),0)%11;return 10!==r?r===s:o.slice(0,10).reduce(((e,n,t)=>e+n*a[t]),0)%11===s}Office.actions.associate("onMessageSendHandler",onMessageSendHandler);